import requests

url = "http://0.0.0.0:8000/multimodal/conversation"
payload = {
    "model": "llava-xxx",
    "messages": [
        {
        "role": "user",
        "content": [
            {"image": "ctcl-118.jpg"},
            {"text": "<image>\nThe image is from the dermatology category: Actinic Keratosis Basal Cell Carcinoma and other Malignant Lesions.\nPlease generate a diagnostic report based on the skin images uploaded by the patient and the relevant knowledge about the skin condition provided. \nRelevant knowledge: {\n  \"disease\": [\n    {\n      \"question\": \"What is Actinic Keratosis Basal Cell Carcinoma and other Malignant Lesions?\",\n      \"confidence\": 0.9936,\n      \"text\": \"# Actinic keratosis Actinic keratosis ( AK ), sometimes called solar keratosis or senile keratosis , [1][2] is a pre-cancerous [3] area of thick, scaly, or crusty skin. [4][5] Actinic keratosis is a disorder ( -osis ) of epidermal keratinocytes that is induced by ultraviolet (UV) light exposure ( actin-). [6] These growths are more common in fair-skinned people and those who are frequently in the sun. [7] They are believed to form when skin gets damaged by UV radiation from the sun or indoor tanning beds, usually over the course of decades. Given their pre-cancerous nature, if left untreated, they may turn into a type of skin cancer called squamous cell carcinoma. [5] Untreated lesions have up to a 20% risk of progression to squamous cell carcinoma, [8] so treatment by a dermatologist is recommended.\"\n    },\n    {\n      \"question\": \"What is Actinic Keratosis Basal Cell Carcinoma and other Malignant Lesions?\",\n      \"confidence\": 0.9086,\n      \"text\": \"## Diagnosis Physicians usually diagnose actinic keratosis by doing a thorough physical examination, through a combination of visual observation and touch. However a biopsy may be necessary when the keratosis is large in diameter, thick, or bleeding, in order to make sure that the lesion is not a skin cancer. Actinic keratosis may progress to invasive squamous cell carcinoma (SCC) but both diseases can present similarly upon physical exam and can be difficult to distinguish clinically. [6] Histological examination of the lesion from a biopsy or excision may be necessary to definitively distinguish actinic keratosis from in situ or invasive SCC. [6] In addition to SCCs, actinic keratoses can be mistaken for other cutaneous lesions including seborrheic keratoses, basal cell carcinoma, lichenoid keratosis,\"\n    }\n  ],\n  \"treatment\": [\n    {\n      \"question\": \"What are the recommended treatment options for Actinic Keratosis Basal Cell Carcinoma and other Malignant Lesions?\",\n      \"confidence\": 0.9936,\n      \"text\": \"If clinical examination findings are not typical of actinic keratosis and the possibility of in situ or invasive squamous cell carcinoma (SCC) cannot be excluded based on clinical examination alone, a biopsy or excision can be considered for definitive diagnosis by histologic examination of the lesional tissue. [11] Multiple treatment options for actinic keratosis are available. Photodynamic therapy (PDT) is one option for the treatment of numerous actinic keratosis lesions in a region of the skin, termed field cancerization. [12] It involves the application of a photosensitizer to the skin followed by illumination with a strong light source. Topical creams, such as 5-fluorouracil or imiquimod, may require daily application to affected skin areas over a typical time course of weeks. [13]\"\n    },\n    {\n      \"question\": \"What are the recommended treatment options for Actinic Keratosis Basal Cell Carcinoma and other Malignant Lesions?\",\n      \"confidence\": 0.9502,\n      \"text\": \"# Retinoids Topical retinoids have been studied in the treatment of actinic keratosis with modest results, and the American Academy of Dermatology does not recommend this as first-line therapy. [66] Treatment with adapalene gel daily for 4 weeks, and then twice daily thereafter for a total of nine months led to a significant but modest reduction in the number of actinic keratoses compared to placebo; it demonstrated the additional advantage of improving the appearance of photodamaged skin. [67] Topical tretinoin is ineffective as treatment for reducing the number of actinic keratoses. [25] For secondary prevention of actinic keratosis, systemic, low-dose acitretin was found to be safe, well tolerated and moderately effective in chemoprophylaxis for skin cancers in kidney transplant patients. [68] Acitretin is a viable treatment option for organ transplant patients according to expert opinion. [46] ## Tirbanibulin\"\n    }\n  ]\n}\nPlease output strictly in JSON format, without any extra explanation:\n{{\n  \"Disease Name\": \"<predicted disease name>\",\n  \"Symptom Description\": \"<simple description of patient's skin condition symptoms>\",\n  \"Treatment Plan Recommendation\": \"<given this patient's skin condition and the relevant knowledge about this dermatological disorder, please provide your treatment plan recommendation.>\"\n}}"}
        ]
        }
    ],
    "top_p": 0.9,
    "temperature": 1.0
}

resp = requests.post(url, json=payload, timeout=120)
print(resp.json()["output"]["choices"][0]["message"]["content"])